<head><head>
    <meta charset="UTF-8">
    <title>Document</title>
    <link rel="stylesheet" type="text/css" href="../css/shCore.css">
    <!--    <link rel="stylesheet" type="text/css" href="syntaxhighlighter/css/shThemeArticle.css">-->
    <link rel="stylesheet" type="text/css" href="../css/shThemeFadeToGrey.css">
    <script type="text/javascript" src="../js/XRegExp.js"></script>
    <script type="text/javascript" src="../js/shCore.js"></script>
    <script type="text/javascript" src="../js/shBrushJava.js"></script>
    <script type="text/javascript" src="../js/shBrushPowerShell.js"></script>
    <script type="text/javascript" src="../js/shBrushJScript.js"></script>
    <script type="text/javascript" src="../js/shBrushSql.js"></script>
    <script type="text/javascript" src="../js/shBrushXml.js"></script>
    <script type="text/javascript" src="../js/shBrushPlain.js"></script>
    <script type="text/javascript" src="../js/shBrushKotlin.js"></script>
    <script type="text/javascript">
        SyntaxHighlighter.all()
        function onTouchStart(e) {
            androidApi.touchEvent(0);
        }
        function onTouchEnd(e) {
            androidApi.touchEvent(2);
        }
         function onTouchMove(e) {
            androidApi.touchEvent(1);
        }
        function addTouchListener() {
            var dom = document.getElementsByClassName('code');
            androidApi.log(dom.length);
            for (i in dom){
                dom[i].addEventListener('touchstart', onTouchStart, false);
                dom[i].addEventListener('touchmove', onTouchMove, false);
                dom[i].addEventListener('touchend', onTouchEnd, false);
            }
        }
        </script>
    <style>
        img {
            max-width: 100%;
        }
        .code_block{
            display: block;
            overflow-x: auto;
            padding: .5em;
            background: #f0f0f0;
        }
        .key_word{
            word-break: break-word;
            border-radius: 2px;
            margin-left: 3px;
            margin-right: 3px;
            overflow-x: auto;
            background-color: #f7f7f7;
            color: #ff502c;
            font-size: .87em;
            padding: .065em .4em!important;
            display: inline!important;
        }
    </style>
</head>
<body>
<h1>è‡ªå®šä¹‰æ§ä»¶-é˜³å…‰æ²™æ»©ç”¨æˆ·å¤´åƒ</h1>
<p><img src="https://images.sunofbeaches.com/content/2021_07_22/867893313296924672.jpg" alt="å›¾ç‰‡æè¿°"></p>
<h2>å¼€å‘éœ€æ±‚</h2>
<ul>
    <li>åœ¨é˜³å…‰æ²™æ»©å®¢æˆ·ç«¯ä¸­ä¼šæœ‰å¤§é‡çš„æ˜¾ç¤ºç”¨æˆ·å¤´åƒçš„åœ°æ–¹ï¼Œä¾‹å¦‚æ–‡ç« åˆ—è¡¨ã€æ‘¸é±¼åˆ—è¡¨ã€ç›¸å…³è¯„è®ºä¸­éƒ½ä¼šç”¨åˆ°ï¼Œå¹¶ä¸”åœ¨ä¸åŒåœ°æ–¹ä»–ä»¬çš„å¤§å°å’Œæ ·å¼å¯èƒ½ä¹Ÿä¸ä¸€æ ·ï¼Œè¿˜æœ‰å°±æ˜¯Vipå’Œæ™®é€šç”¨æˆ·ä¹Ÿæœ‰ä¸åŒæ ‡å¿—ï¼Œå› æ­¤éœ€è¦ç”¨åˆ°è‡ªå®šä¹‰æ§ä»¶ï¼Œå¹¶ä¸”æ§ä»¶åº”è¯¥è‡ªé€‚åº”å¤§å°å’Œé€šè¿‡å…¶å±æ€§æ§åˆ¶æ§ä»¶çš„æ ·å¼
        <ol>
            <li>æ§ä»¶è‡ªé€‚åº”</li>
            <li>å±æ€§æ§åˆ¶æ§ä»¶çš„å½¢çŠ¶</li>
            <li>å±æ€§æ§åˆ¶æ§ä»¶çš„VIPå’ŒéVIPçš„æ ·å¼</li>
        </ol> </li>
</ul>
<h2>å¼€å‘çŸ¥è¯†é¢„çƒ­</h2>
<ul>
    <li> <p>Paintçš„xfermodeçš„åº”ç”¨</p> <p>ç”±äºå›¾ç‰‡çš„å½¢çŠ¶æ˜¯çŸ©å½¢ï¼Œè€Œåœ¨è‡ªå®šä¹‰è¿‡ç¨‹ä¸­æˆ‘ä»¬è¦å°†å¤´åƒè®¾ç½®æˆåœ†å½¢æˆ–åœ†è§’çŸ©å½¢ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨<span class="key_word">Paint</span>çš„<span class="key_word">xfermode</span>å®ç°, å½“å–ä¸åŒçš„å€¼æ˜¯å¯ä»¥å°†å¾—åˆ°ä¸¤å¼ å›¾ç‰‡çš„å¹¶é›†ã€åˆé›†ç­‰ç­‰ï¼Œå…·ä½“çŸ¥è¯†å¯ä»¥å‚çœ‹æ–‡ç« ï¼š<a href="https://www.jianshu.com/p/d11892bbe055">å„ä¸ªå‡»ç ´ææ˜ç™½PorterDuff.Mode</a>ã€‚åœ¨å½“å‰éœ€æ±‚ä¸­æˆ‘ä»¬ä½¿ç”¨<span class="key_word">PorterDuff.Mode.SRC_IN</span>,åœ¨æ­¤æ¨¡å¼ä¸‹ï¼š 1. åœ¨ä¸¤è€…ç›¸äº¤çš„åœ°æ–¹ç»˜åˆ¶æºå›¾åƒ 2. ç»˜åˆ¶çš„æ•ˆæœä¼šå—åˆ°ç›®æ ‡å›¾åƒå¯¹åº”åœ°æ–¹é€æ˜åº¦çš„å½±å“</p> <p>é‡ç‚¹åœ¨äºç¬¬ä¸€ç‚¹ï¼Œç¬¬äºŒç‚¹ç”±äºéœ€æ±‚æ²¡æœ‰æ¶‰åŠåˆ°é€æ˜åº¦çš„é—®é¢˜æ‰€ä»¥ç”¨ä¸åˆ°è¿™ä¸ªå±æ€§ã€‚è€Œå®ç°åœ†å½¢å’Œåœ†è§’çŸ©å½¢å°±æ˜¯åœ¨canvsä¸Šç»˜åˆ¶éœ€è¦çš„å›¾åƒå½¢çŠ¶ï¼Œç„¶åè®¾ç½®<span class="key_word">xfermode</span>,æœ€ç»ˆç»˜åˆ¶åŸå›¾åƒï¼Œå³å¯è·å–åˆ°æ‰€éœ€å½¢çŠ¶çš„å›¾åƒ</p> <p>ç»˜åˆ¶åœ†è§’çŸ©å½¢å›¾ç‰‡çš„ä»£ç ç¤ºä¾‹ï¼š</p> <pre class="code_block"><div><div id="highlighter_7016" class="syntaxhighlighter  kotlin"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="kotlin keyword">private</code> <code class="kotlin keyword">fun</code> <code class="kotlin plain">createRoundImage(bitmap: Bitmap, width: Int, height: Int): Bitmap{</code></div><div class="line number2 index1 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">paint.isAntiAlias = </code><code class="kotlin keyword">true</code></div><div class="line number3 index2 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">val</code> <code class="kotlin plain">target = Bitmap.createBitmap(bitmap.width, bitmap.width, Bitmap.Config.ARGB_8888)</code></div><div class="line number4 index3 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">val</code> <code class="kotlin plain">canvas = Canvas(target)</code></div><div class="line number5 index4 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">val</code> <code class="kotlin plain">min = Math.min(bitmap.width, bitmap.height)</code></div><div class="line number6 index5 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">val</code> <code class="kotlin plain">dstRect = Rect(</code><code class="kotlin value">0</code><code class="kotlin plain">, </code><code class="kotlin value">0</code><code class="kotlin plain">, width, height)</code></div><div class="line number7 index6 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">val</code> <code class="kotlin plain">srcRect = Rect(</code><code class="kotlin value">0</code><code class="kotlin plain">, </code><code class="kotlin value">0</code><code class="kotlin plain">, min, min)</code></div><div class="line number8 index7 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">val</code> <code class="kotlin plain">backgroundRect = RectF(</code><code class="kotlin value">0</code><code class="kotlin plain">.0f + borderWidth,</code><code class="kotlin value">0</code><code class="kotlin plain">.0f + borderWidth, width.toFloat() - borderWidth, height.toFloat() - borderWidth)</code></div><div class="line number9 index8 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">val</code> <code class="kotlin plain">roundR = ScreenUtils.dip2px(context, 8f).toFloat()</code></div><div class="line number10 index9 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">canvas.drawRoundRect(backgroundRect, roundR - borderWidth, roundR - borderWidth, paint)</code></div><div class="line number11 index10 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin comments">// æ ¸å¿ƒä»£ç å–ä¸¤ä¸ªå›¾ç‰‡çš„äº¤é›†éƒ¨åˆ†</code></div><div class="line number12 index11 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">paint.xfermode = PorterDuffXfermode(PorterDuff.Mode.SRC_IN)</code></div><div class="line number13 index12 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">canvas.drawBitmap(bitmap, srcRect, dstRect, paint)</code></div><div class="line number14 index13 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">paint.xfermode = </code><code class="kotlin keyword">null</code></div><div class="line number15 index14 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">return</code> <code class="kotlin plain">target</code></div><div class="line number16 index15 alt1"><code class="kotlin plain">}</code></div></div></td></tr></tbody></table></div></div></pre> </li>
    <li> <p>GlideåŠ è½½å›¾ç‰‡çš„ç›‘å¬ åœ¨glideçš„ä½¿ç”¨ä¸­æœ€ç®€å•å’Œæœ€é¢‘ç¹çš„ä½¿ç”¨çš„ä»£ç æ˜¯ï¼š</p> <pre class="code_block"><div><div id="highlighter_503329" class="syntaxhighlighter  kotlin"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="kotlin plain">Glide.</code><code class="kotlin keyword">with</code><code class="kotlin plain">(context).load(url).into(iv)</code></div></div></td></tr></tbody></table></div></div></pre> <p>ä½†æ˜¯åœ¨æœ¬æ¬¡éœ€æ±‚ä¸­æˆ‘ä»¬è¦å†è®¾ç½®çš„å›¾ç‰‡åå»åˆ›å»ºæŒ‡å®šå½¢çŠ¶çš„å›¾ç‰‡å’Œç»˜åˆ¶å…¶ä»–VIPç›¸å…³çš„æ ·å¼ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦è®©æ§ä»¶ä½•æ—¶è¢«è®¾ç½®äº†å›¾ç‰‡ç„¶åå»è°ƒç”¨postInvalidate()é‡æ–°ç»˜åˆ¶å›¾ç‰‡</p> <p>è®¾ç½®glideåŠ è½½å›¾ç‰‡çš„ä»£ç ç¤ºä¾‹ï¼š</p> <pre class="code_block"><div><div id="highlighter_641028" class="syntaxhighlighter  kotlin"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="kotlin comments">//ä½¿ç”¨äº†ViewDataBingä¸­çš„è‡ªå®šä¹‰å±æ€§</code></div><div class="line number2 index1 alt1"><code class="kotlin color1">@BindingAdapter</code><code class="kotlin plain">(</code><code class="kotlin string">"avatar"</code><code class="kotlin plain">)</code></div><div class="line number3 index2 alt2"><code class="kotlin keyword">fun</code> <code class="kotlin plain">setAvatarImage(iv: SobAvatarView, avatar:String){</code></div><div class="line number4 index3 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">Glide.</code><code class="kotlin keyword">with</code><code class="kotlin plain">(iv.context)</code></div><div class="line number5 index4 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">.asBitmap()</code></div><div class="line number6 index5 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">.load(avatar)</code></div><div class="line number7 index6 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">.listener(object:RequestListener&lt;Bitmap&gt;{</code></div><div class="line number8 index7 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">override </code><code class="kotlin keyword">fun</code> <code class="kotlin plain">onLoadFailed(</code></div><div class="line number9 index8 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">e: GlideException?,</code></div><div class="line number10 index9 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">model: Any?,</code></div><div class="line number11 index10 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">target: Target&lt;Bitmap&gt;?,</code></div><div class="line number12 index11 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">isFirstResource: Boolean</code></div><div class="line number13 index12 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">): Boolean {</code></div><div class="line number14 index13 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">return</code> <code class="kotlin keyword">true</code></div><div class="line number15 index14 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">}</code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">override </code><code class="kotlin keyword">fun</code> <code class="kotlin plain">onResourceReady(</code></div><div class="line number18 index17 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">resource: Bitmap?,</code></div><div class="line number19 index18 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">model: Any?,</code></div><div class="line number20 index19 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">target: Target&lt;Bitmap&gt;?,</code></div><div class="line number21 index20 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">dataSource: DataSource?,</code></div><div class="line number22 index21 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">isFirstResource: Boolean</code></div><div class="line number23 index22 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">): Boolean {</code></div><div class="line number24 index23 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin comments">//èµ„æºå‡†å¤‡å®Œæ¯•,è®¾ç½®å›¾ç‰‡å¹¶åˆ·æ–°æ§ä»¶</code></div><div class="line number25 index24 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">iv.setImageBitmap(resource)</code></div><div class="line number26 index25 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">iv.update()</code></div><div class="line number27 index26 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">return</code> <code class="kotlin keyword">true</code></div><div class="line number28 index27 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">}</code></div><div class="line number29 index28 alt2">&nbsp;</div><div class="line number30 index29 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">}).into(iv)</code></div><div class="line number31 index30 alt2"><code class="kotlin plain">}</code></div></div></td></tr></tbody></table></div></div></pre> <p>è¡¥å……å°çŸ¥è¯†ï¼šä½¿ç”¨glideç›´æ¥è®¾ç½®å›¾ç‰‡åœ†è§’</p> <pre class="code_block"><div><div id="highlighter_466760" class="syntaxhighlighter  kotlin"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="kotlin comments">//ä½¿ç”¨äº†ViewDataBingä¸­çš„è‡ªå®šä¹‰å±æ€§</code></div><div class="line number2 index1 alt1"><code class="kotlin color1">@BindingAdapter</code><code class="kotlin plain">(value=[</code><code class="kotlin string">"pic_url"</code><code class="kotlin plain">, </code><code class="kotlin string">"pic_corner"</code><code class="kotlin plain">], requireAll = </code><code class="kotlin keyword">false</code><code class="kotlin plain">)</code></div><div class="line number3 index2 alt2"><code class="kotlin keyword">fun</code> <code class="kotlin plain">setImageViewCorner(iv: ImageView, pic_url:String?, pic_corner: Int?){</code></div><div class="line number4 index3 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">pic_url?.</code><code class="kotlin keyword">let</code> <code class="kotlin plain">{</code></div><div class="line number5 index4 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">var</code> <code class="kotlin plain">override:RequestOptions? = </code><code class="kotlin keyword">null</code></div><div class="line number6 index5 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">pic_corner?.</code><code class="kotlin keyword">let</code> <code class="kotlin plain">{</code></div><div class="line number7 index6 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">if</code><code class="kotlin plain">(pic_corner &gt; </code><code class="kotlin value">0</code><code class="kotlin plain">){</code></div><div class="line number8 index7 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">val</code> <code class="kotlin plain">corners = RoundedCorners(ScreenUtils.dp2px(pic_corner))</code></div><div class="line number9 index8 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">override = RequestOptions.bitmapTransform(corners)</code></div><div class="line number10 index9 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">}</code></div><div class="line number11 index10 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">}</code></div><div class="line number12 index11 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">if</code> <code class="kotlin plain">(override == </code><code class="kotlin keyword">null</code><code class="kotlin plain">) {</code></div><div class="line number13 index12 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">Glide.</code><code class="kotlin keyword">with</code><code class="kotlin plain">(iv.context).load(pic_url).into(iv)</code></div><div class="line number14 index13 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">}</code><code class="kotlin keyword">else</code><code class="kotlin plain">{</code></div><div class="line number15 index14 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">Glide.</code><code class="kotlin keyword">with</code><code class="kotlin plain">(iv.context).load(pic_url).</code><code class="kotlin keyword">apply</code><code class="kotlin plain">(override!!).into(iv)</code></div><div class="line number16 index15 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">}</code></div><div class="line number17 index16 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">}</code></div><div class="line number18 index17 alt1"><code class="kotlin plain">}</code></div></div></td></tr></tbody></table></div></div></pre> </li>
    <li> <p>DataBingåœ¨ä¸ºè‡ªå®šä¹‰å±æ€§ç»‘å®šèµ‹å€¼ä¸­é‡åˆ°çš„é—®é¢˜</p> <p>åœ¨æ­¤æ¬¡éœ€æ±‚ä¸­isVipå±æ€§æ˜¯é€šè¿‡DataBingç»‘å®šç»™æ§ä»¶çš„ï¼Œä½¿ç”¨<span class="key_word">{data.isVip}</span>åç¼–è¯‘ä¼šæŠ¥é”™ï¼Œè¯´æ‰¾ä¸è¿™ä¸ªæ¥å£ï¼Œå› æ­¤éœ€è¦åœ¨æ§ä»¶ä¸­åˆ›å»ºå‡½æ•°isVip(vip:Boolean)è§£å†³è¯¥é—®é¢˜</p> <pre class="code_block"><div><div id="highlighter_698320" class="syntaxhighlighter  kotlin"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="kotlin keyword">fun</code> <code class="kotlin plain">isVip(vip:Boolean){</code></div><div class="line number2 index1 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">isVip = vip</code></div><div class="line number3 index2 alt2"><code class="kotlin comments">//å‚æ•°ç½®ä¸º0ï¼Œç»˜ç”»æ—¶é‡æ–°æ–°è®¡ç®—å‚æ•°</code></div><div class="line number4 index3 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">viewHeight = </code><code class="kotlin value">0</code></div><div class="line number5 index4 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">viewWidth = </code><code class="kotlin value">0</code></div><div class="line number6 index5 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">postInvalidate()</code></div><div class="line number7 index6 alt2"><code class="kotlin plain">}</code></div></div></td></tr></tbody></table></div></div></pre> </li>
</ul>
<h2>å¼€å§‹æ•²ä»£ç </h2>
<ol>
    <li> <p>æ ¹æ®éœ€æ±‚è‡ªå®šä¹‰å±æ€§å¦‚ä¸‹ï¼š</p> <pre class="code_block"><div><div id="highlighter_639103" class="syntaxhighlighter  xml"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">&lt;</code><code class="xml keyword">declare-styleable</code> <code class="xml color1">name</code><code class="xml plain">=</code><code class="xml string">"SobAvatarView"</code><code class="xml plain">&gt;</code></div><div class="line number2 index1 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">attr</code> <code class="xml color1">name</code><code class="xml plain">=</code><code class="xml string">"isCircle"</code> <code class="xml color1">format</code><code class="xml plain">=</code><code class="xml string">"boolean"</code><code class="xml plain">/&gt;</code></div><div class="line number3 index2 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">attr</code> <code class="xml color1">name</code><code class="xml plain">=</code><code class="xml string">"isVip"</code> <code class="xml color1">format</code><code class="xml plain">=</code><code class="xml string">"boolean"</code><code class="xml plain">/&gt;</code></div><div class="line number4 index3 alt1"><code class="xml plain">&lt;/</code><code class="xml keyword">declare-styleable</code><code class="xml plain">&gt;</code></div></div></td></tr></tbody></table></div></div></pre> </li>
    <li> <p>ç¼–å†™æ§ä»¶ä»£ç </p>
        <ol>
            <li> <p>åˆå§‹åŒ–è·å–è‡ªå®šä¹‰å±æ€§çš„å€¼</p> <pre class="code_block"><div><div id="highlighter_469653" class="syntaxhighlighter  kotlin"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="kotlin plain">init {</code></div><div class="line number2 index1 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">val</code> <code class="kotlin plain">obtainStyledAttributes = context.obtainStyledAttributes(attrs, R.styleable.SobAvatarView)</code></div><div class="line number3 index2 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">isCircle = obtainStyledAttributes.getBoolean(R.styleable.SobAvatarView_isCircle, isCircle)</code></div><div class="line number4 index3 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">isVip = obtainStyledAttributes.getBoolean(R.styleable.SobAvatarView_isVip, isVip)</code></div><div class="line number5 index4 alt2"><code class="kotlin plain">}</code></div></div></td></tr></tbody></table></div></div></pre> </li>
            <li> <p>ç¼–å†™onDrawä»£ç </p> </li>
        </ol> <pre class="code_block"><div><div id="highlighter_594749" class="syntaxhighlighter  kotlin"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">override </code><code class="kotlin keyword">fun</code> <code class="kotlin plain">onDraw(canvas: Canvas?) {</code></div><div class="line number2 index1 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">canvas?.</code><code class="kotlin keyword">let</code> <code class="kotlin plain">{</code></div><div class="line number3 index2 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin comments">//æ£€æŸ¥éœ€è¦é‡æ–°åˆå§‹åŒ–ç›¸å…³å±æ€§</code></div><div class="line number4 index3 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">if</code><code class="kotlin plain">(viewHeight == </code><code class="kotlin value">0</code> <code class="kotlin plain">|| viewWidth == </code><code class="kotlin value">0</code><code class="kotlin plain">){</code></div><div class="line number5 index4 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin comments">//è®¡ç®—ç›¸å…³å±æ€§çš„å€¼</code></div><div class="line number6 index5 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">calcValues()</code></div><div class="line number7 index6 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">}</code></div><div class="line number8 index7 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin comments">//åˆ¤æ–­ç”»é‚£ç§æ ·å¼</code></div><div class="line number9 index8 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">if</code><code class="kotlin plain">(isCircle){</code></div><div class="line number10 index9 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">drawCircleStyle(it)</code></div><div class="line number11 index10 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">}</code><code class="kotlin keyword">else</code><code class="kotlin plain">{</code></div><div class="line number12 index11 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">drawRoundStyle(it)</code></div><div class="line number13 index12 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">}</code></div><div class="line number14 index13 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin comments">//ç”»å­—æ¯V</code></div><div class="line number15 index14 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">drawLetterV(it)</code></div><div class="line number16 index15 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">}</code></div><div class="line number17 index16 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">if</code> <code class="kotlin plain">(canvas == </code><code class="kotlin keyword">null</code><code class="kotlin plain">) {</code></div><div class="line number18 index17 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">super</code><code class="kotlin plain">.draw(canvas)</code></div><div class="line number19 index18 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">}</code></div><div class="line number20 index19 alt1"><code class="kotlin plain">}</code></div></div></td></tr></tbody></table></div></div></pre>
        <ol>
            <li>ç›¸å…³å±æ€§çš„å€¼çš„è®¡ç®—</li>
        </ol> <pre class="code_block"><div><div id="highlighter_283839" class="syntaxhighlighter  kotlin"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="kotlin preprocessor">/**</code></div><div class="line number2 index1 alt1"><code class="kotlin spaces">&nbsp;</code><code class="kotlin preprocessor">* è®¡ç®—ç›¸å…³å‚æ•°</code></div><div class="line number3 index2 alt2"><code class="kotlin spaces">&nbsp;</code><code class="kotlin preprocessor">*/</code></div><div class="line number4 index3 alt1"><code class="kotlin keyword">private</code> <code class="kotlin keyword">fun</code> <code class="kotlin plain">calcValues() {</code></div><div class="line number5 index4 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin comments">//è®¡ç®—æ§ä»¶çš„å®½é«˜</code></div><div class="line number6 index5 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">viewHeight = height - paddingBottom - paddingTop</code></div><div class="line number7 index6 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">viewWidth = width - paddingStart - paddingEnd</code></div><div class="line number8 index7 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin comments">//å°†è®¾ç½®çš„å›¾ç‰‡è½¬åŒ–ä¸ºæ§ä»¶å¤§å°çš„Bitmap</code></div><div class="line number9 index8 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">val</code> <code class="kotlin plain">image: Bitmap = drawableToBitmap(drawable)</code></div><div class="line number10 index9 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">val</code> <code class="kotlin plain">resSizeBitmap = resizeBitmap(image, viewWidth, viewHeight)</code></div><div class="line number11 index10 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin comments">//VIP broadå®½åº¦</code></div><div class="line number12 index11 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">borderWidth =</code></div><div class="line number13 index12 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">(defBorderWidth * </code><code class="kotlin value">1.0</code> <code class="kotlin plain">* (viewWidth * </code><code class="kotlin value">1.0</code> <code class="kotlin plain">/ ScreenUtils.dip2px(context, 60f))).toInt()</code></div><div class="line number14 index13 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin comments">//VIPå›¾æ ‡åŠå¾„</code></div><div class="line number15 index14 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">smallR = viewWidth / </code><code class="kotlin value">2</code><code class="kotlin plain">.0f - ((viewWidth - borderWidth) / </code><code class="kotlin value">2</code><code class="kotlin plain">.0f) * (sqrt2 / </code><code class="kotlin value">2</code><code class="kotlin plain">.0f).toFloat()</code></div><div class="line number16 index15 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">if</code> <code class="kotlin plain">(isCircle) {</code></div><div class="line number17 index16 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin comments">//åœ†å½¢å¤´åƒ</code></div><div class="line number18 index17 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">circleBitmap = createCircleImage(resSizeBitmap, viewWidth, viewHeight)</code></div><div class="line number19 index18 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">} </code><code class="kotlin keyword">else</code> <code class="kotlin plain">{</code></div><div class="line number20 index19 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin comments">//åœ†è§’çŸ©å½¢å¤´åƒ</code></div><div class="line number21 index20 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">roundBitmap = createRoundImage(resSizeBitmap, viewWidth, viewHeight)</code></div><div class="line number22 index21 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">}</code></div><div class="line number23 index22 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">vipIconRect = RectF(</code></div><div class="line number24 index23 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">viewWidth - </code><code class="kotlin value">2</code> <code class="kotlin plain">* smallR, viewWidth - </code><code class="kotlin value">2</code> <code class="kotlin plain">* smallR,</code></div><div class="line number25 index24 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">viewWidth.toFloat(), viewHeight.toFloat()</code></div><div class="line number26 index25 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">)</code></div><div class="line number27 index26 alt2"><code class="kotlin plain">}</code></div></div></td></tr></tbody></table></div></div></pre>
        <ol>
            <li>åˆ·æ–°å¤´åƒæ•°æ®çš„æ¥å£</li>
        </ol> <pre class="code_block"><div><div id="highlighter_482032" class="syntaxhighlighter  kotlin"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="kotlin preprocessor">/**</code></div><div class="line number2 index1 alt1"><code class="kotlin spaces">&nbsp;</code><code class="kotlin preprocessor">* æä¾›ç»™å¤–éƒ¨è®¾ç½®å¤´åƒåç”¨æ¥åˆ·æ–°æ•°æ®çš„æ¥å£</code></div><div class="line number3 index2 alt2"><code class="kotlin spaces">&nbsp;</code><code class="kotlin preprocessor">*/</code></div><div class="line number4 index3 alt1"><code class="kotlin keyword">fun</code> <code class="kotlin plain">update() {</code></div><div class="line number5 index4 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin comments">//å‚æ•°ç½®ä¸º0ï¼Œç»˜ç”»æ—¶é‡æ–°æ–°è®¡ç®—å‚æ•°</code></div><div class="line number6 index5 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">viewHeight = </code><code class="kotlin value">0</code></div><div class="line number7 index6 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">viewWidth = </code><code class="kotlin value">0</code></div><div class="line number8 index7 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">postInvalidate()</code></div><div class="line number9 index8 alt2"><code class="kotlin plain">}</code></div></div></td></tr></tbody></table></div></div></pre>
        <ol>
            <li> <p>å°ç»“</p> </li>
            <li> <p>é˜³å…‰æ²™æ»©ç”¨æˆ·å¤´åƒçš„è‡ªå®šä¹‰Viewçš„ä»£ç åˆ†äº«å¦‚ä¸Šï¼Œé™¤äº†ä»¥ä¸Šæ–¹æ³•ä¸ºè¿˜æœ‰å…¶ä½™æ–¹æ³•éƒ½æ˜¯ç®€å•çš„åŠŸèƒ½å‡½æ•°ï¼Œé¿å…ç¯‡å¹…è¿‡å¤§ï¼Œæš‚ä¸åšåˆ†äº«ï¼Œè¯¦ç»†ä»£ç å¯ä»¥<a href="https://github.com/coder-zt/SOBBlog/blob/master/app/src/main/java/com/coder/zt/sobblog/ui/view/SobAvatarView.kt">åœ¨è¿™é‡Œ</a>é˜…è¯»ã€‚å¸Œæœ›xdjmmèƒ½é˜…è¯»é˜…è¯»ä»£ç ï¼ŒæŒ‡å‡ºä¸è¶³çš„åœ°æ–¹ï¼Œç›¸äº’å­¦ä¹ ï¼Œå“ˆå“ˆå“ˆã€‚</p> </li>
        </ol> </li>
</ol>
<h2>æ€»ç»“</h2>
<ul>
    <li> <p>å¥½ä¹…éƒ½æ²¡å†™æ–‡ç« äº†ï¼Œè‚šå­é‡Œä¹Ÿæ²¡ä»€ä¹ˆå¢¨æ°´äº†ï¼Œå› æ­¤æ–‡ç« å¤§éƒ¨åˆ†éƒ½æ˜¯ä»£ç ï¼Œä½†æ˜¯å…³é”®æ³¨é‡Šè¿˜æ˜¯æœ‰çš„ï¼Œå¸Œæœ›å¤§å®¶é€šè¿‡æ–‡ç« èƒ½å¤Ÿå­¦ä¹ åˆ°å…³äºè‡ªå®šä¹‰Viewçš„ç›¸å…³çŸ¥è¯†ï¼Œå¦‚æœä»£ç é˜…è¯»è¿‡ç¨‹ä¸­é‡åˆ°ä¸è¶³çš„åœ°æ–¹æ¬¢è¿åœ¨è¯„è®ºåŒºæŒ‡å‡ºçº æ­£ï¼Œå¤§å®¶ä¸€èµ·å­¦ä¹ ï¼Œå…±åŒè¿›æ­¥ï¼›ä¸€ç›´è§‰å¾—ç¨‹åºçŒ¿ï¼ˆåª›ï¼‰å†™ä»£ç çš„æ—¶é—´å æ®äº†å¤§éƒ¨åˆ†ï¼Œåœ¨å¤§éƒ¨åˆ†æ—¶é—´æ•ˆç‡è¾ƒä½ï¼Œè€Œå¯¹ä»£ç çš„å•†é‡ä¸æ€è€ƒæ—¶é—´è¾ƒå°‘ï¼Œæ‰€ä»¥å¸Œæœ›é˜³å…‰æ²™æ»©èƒ½è¶Šæ¥è¶Šçƒ­é—¹ï¼Œxdjmmèƒ½åœ¨è¿™é‡Œæ„‰å¿«çš„äº¤æµåˆ†äº«çŸ¥è¯†ã€‚è‡³å°‘ç°åœ¨å¯¹äºæˆ‘æ¥è¯´ä»£ç èƒ½ä½¿æ„Ÿåˆ°æ„‰å¿«ï¼Œå¸Œæœ›ä»¥åä¹Ÿå¦‚æ­¤ï¼</p> </li>
    <li> <p>æœ€åæ˜¯å…³äºé˜³å…‰æ²™å®¢æˆ·ç«¯æ–‡ç« è¯¦æƒ…çš„é¢„å‘Šï¼Œå› ä¸ºæ–‡ç« çš„æ ·å¼å·²ç»ä¼˜åŒ–çš„ä¸é”™äº†ï¼ˆåœ¨æˆ‘çœ‹æ¥æ˜¯ğŸ¤­ï¼‰ï¼Œäº‰å–è¿™å‘¨æ—¥åˆ†äº«å‡ºæ¥ï¼Œæ•¬è¯·æœŸå¾…ã€‚ã€‚ã€‚</p> </li>
</ul>

</body></head>