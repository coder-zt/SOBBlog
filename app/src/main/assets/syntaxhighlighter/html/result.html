<head><head>
    <meta charset="UTF-8">
    <title>Document</title>
    <link rel="stylesheet" type="text/css" href="../css/shCore.css">
    <link rel="stylesheet" type="text/css" href="../css/shThemeArticle.css">
    <!--        <link rel="stylesheet" type="text/css" href="../css/shThemeFadeToGrey.css">-->
    <script type="text/javascript" src="../js/XRegExp.js"></script>
    <script type="text/javascript" src="../js/shCore.js"></script>
    <script type="text/javascript" src="../js/shBrushJava.js"></script>
    <script type="text/javascript" src="../js/shBrushPowerShell.js"></script>
    <script type="text/javascript" src="../js/shBrushJScript.js"></script>
    <script type="text/javascript" src="../js/shBrushSql.js"></script>
    <script type="text/javascript" src="../js/shBrushXml.js"></script>
    <script type="text/javascript" src="../js/shBrushPlain.js"></script>
    <script type="text/javascript" src="../js/shBrushKotlin.js"></script>
    <script type="text/javascript">
        ...all()
        function onTouchStart(e) {
            androidApi.touchEvent(0);
        }
        function onTouchEnd(e) {
            androidApi.touchEvent(2);
        }
         function onTouchMove(e) {
            androidApi.touchEvent(1);
        }
        function addTouchListener() {
            var dom = document.getElementsByClassName('code');
            androidApi.log(dom.length);
            for (i in dom){
                dom[i].addEventListener('touchstart', onTouchStart, false);
                dom[i].addEventListener('touchmove', onTouchMove, false);
                dom[i].addEventListener('touchend', onTouchEnd, false);
            }
        }
        </script>
    <style>
        img {
            max-width:200px;
        }

        ul {
         width: 100%;
        }

        .too-len {
         width: 100%;
         display:block;
        }
        .code_block{
            display: block;
            overflow-x: auto;
            padding: .5em;
            background: #2b2b2b;
        }
        .key_word{
            word-break: break-word;
            border-radius: 2px;
            margin-left: 3px;
            margin-right: 3px;
            overflow-x: auto;
            background-color: #f7f7f7;
            color: #ff502c;
            font-size: .87em;
            padding: .065em .4em!important;
            display: inline!important;
        }
    </style>
</head>
<body>
<h1>使用WebView展示博客文章详情(...js的简单使用)</h1>
<p>刚开始开发博客文章详情，由于对于前端知识了解不熟悉，所以选择了使用原生的自定View来完成，但是在开发中发现该方案的成本和效果差强人意，所以改变方式使用WebView结合JS的方案来展示文章详情，既然对前端知识不是很熟悉，那就摸着石头过河，慢慢探索。大不了就是再多掉几根头发</p>
<h3>观察网站的前端</h3>
<ul>
    <li>按下F12查看文章详情页的网页源码</li>
</ul>
<p><img src="https://images.sunofbeaches.com/content/2021_08_09/874322082878455808.png" alt="图片描述"></p>
<ul>
    <li> <p>可以发现代码和关键字是使用了<span class="key_word">&lt;code&gt;</span>标签，并且代码块还带有class属性,第一个表示代码语言类型，及我们在书写md文档是添加的标注，那么<span class="key_word">hljs</span>这个值代表的是什么意思呢，问一下度娘</p> </li>
    <li> <p>搜索之后，第一条记录就是<span class="key_word">highlight.js</span>的结果，刚好hljs就是这个库的简写，所以这个库应该对我们的需求有帮助，这是我第一次知道这个js库，紧接着就是开始搜索<span class="key_word">hightlight.js</span>相关的资料，搜索的相关信息如下：</p>
        <ol>
            <li><a href="https://github.com/highlightjs/highlight.js/">highlight的github地址</a></li>
            <li><a href="https://www.cnblogs.com/wx1993/p/8042226.html">如何使用 highlight.js 高亮代码</a></li>
            <li><a href="https://github.com/../..">..的github地址</a></li>
            <li><a href="https://blog.csdn.net/GrootBaby/article/details/81746211">JS 插件----..的使用</a></li>
        </ol> </li>
</ul>
<p>..这个库是我再搜索highlight库过程中找到的，因为前者可以在github下载资源，并通过本地加载进行文章的渲染，所以在这里选择了后者，接下来就是根据教程编写demo进行测试和学习：</p>
<h3>测试与学习</h3>
<ol>
    <li> <p>下载资源</p>
        <ul>
            <li>从github可以下载该js库的资源，然后将js、css放在assets目录下:</li>
        </ul> <p><img src="https://images.sunofbeaches.com/content/2021_08_11/874810776592842752.png" alt=""></p>
        <ul>
            <li>其中html文件夹下artile_template.html是文章的样板后面才会用到，article_demo.html是根据教程编写的demo，其代码如下:</li>
        </ul> <pre class="code_block"><div><div id="highlighter_791335" class="..  text"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="text plain">&lt;html lang="en"&gt;</code></div><div class="line number2 index1 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;head&gt;</code></div><div class="line number3 index2 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;meta charset="UTF-8"&gt;</code></div><div class="line number4 index3 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;title&gt;Document&lt;/title&gt;</code></div><div class="line number5 index4 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;link rel="stylesheet" type="text/css" href="../css/shCore.css"&gt;</code></div><div class="line number6 index5 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;link rel="stylesheet" type="text/css" href="../css/shThemeDjango.css"&gt;</code></div><div class="line number7 index6 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;script type="text/javascript" src="../js/XRegExp.js"&gt;&lt;/script&gt;</code></div><div class="line number8 index7 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;script type="text/javascript" src="../js/shCore.js"&gt;&lt;/script&gt;</code></div><div class="line number9 index8 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;script type="text/javascript" src="../js/shBrushJava.js"&gt;&lt;/script&gt;</code></div><div class="line number10 index9 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;script type="text/javascript"&gt;</code></div><div class="line number11 index10 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">...all()</code></div><div class="line number12 index11 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;/script&gt;</code></div><div class="line number13 index12 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;/head&gt;</code></div><div class="line number14 index13 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;body&gt;</code></div><div class="line number15 index14 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;pre class="brush: java; collapse: false;"&gt;</code></div><div class="line number16 index15 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">public void javaMethod() {</code></div><div class="line number17 index16 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">int i = 3;</code></div><div class="line number18 index17 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">}</code></div><div class="line number19 index18 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;/pre&gt;</code></div><div class="line number20 index19 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;pre class="brush: java; collapse: false;"&gt;</code></div><div class="line number21 index20 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">public static String utf8ToUnicode(String inStr) {</code></div><div class="line number22 index21 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">char[] myBuffer = inStr.toCharArray();</code></div><div class="line number23 index22 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">StringBuffer sb = new StringBuffer();</code></div><div class="line number24 index23 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">for (int i = 0; i &lt; inStr.length(); i++) {</code></div><div class="line number25 index24 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">UnicodeBlock ub = UnicodeBlock.of(myBuffer[i]);</code></div><div class="line number26 index25 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">if(ub == UnicodeBlock.BASIC_LATIN){</code></div><div class="line number27 index26 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">//英文及数字等</code></div><div class="line number28 index27 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">sb.append(myBuffer[i]);</code></div><div class="line number29 index28 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">}else if(ub == UnicodeBlock.HALFWIDTH_AND_FULLWIDTH_FORMS){</code></div><div class="line number30 index29 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">//全角半角字符</code></div><div class="line number31 index30 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">int j = (int) myBuffer[i] - 65248;</code></div><div class="line number32 index31 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">sb.append((char)j);</code></div><div class="line number33 index32 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">}else{</code></div><div class="line number34 index33 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">//汉字</code></div><div class="line number35 index34 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">short s = (short) myBuffer[i];</code></div><div class="line number36 index35 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">String hexS = Integer.toHexString(s);</code></div><div class="line number37 index36 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">String unicode = "\\u"+hexS;</code></div><div class="line number38 index37 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">sb.append(unicode.toLowerCase());</code></div><div class="line number39 index38 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">}</code></div><div class="line number40 index39 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">}</code></div><div class="line number41 index40 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">return sb.toString();</code></div><div class="line number42 index41 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">}</code></div><div class="line number43 index42 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;/pre&gt;</code></div><div class="line number44 index43 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;pre class="brush: java; collapse: true;"&gt;</code></div><div class="line number45 index44 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">public void javaMethod() {</code></div><div class="line number46 index45 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">int i = 3;</code></div><div class="line number47 index46 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">}</code></div><div class="line number48 index47 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;/pre&gt;</code></div><div class="line number49 index48 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;pre class="brush: java; collapse: true;"&gt;</code></div><div class="line number50 index49 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">public void javaMethod() {</code></div><div class="line number51 index50 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">int i = 3;</code></div><div class="line number52 index51 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">}</code></div><div class="line number53 index52 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;/pre&gt;</code></div><div class="line number54 index53 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;/body&gt;</code></div><div class="line number55 index54 alt2"><code class="text plain">&lt;/html&gt;</code></div></div></td></tr></tbody></table></div></div></pre>
        <ul>
            <li>紧接着就是使用webview加载上面的html</li>
        </ul> <pre class="code_block"><div><div id="highlighter_143054" class="..  kotlin"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="kotlin plain">dataBinding.wvArticle.settings.javaScriptEnabled = </code><code class="kotlin keyword">true</code></div><div class="line number2 index1 alt1"><code class="kotlin comments">//getTestHtml("article_demo")：从assets目录下读取测试数据</code></div><div class="line number3 index2 alt2"><code class="kotlin plain">dataBinding.wvArticle.loadDataWithBaseURL(</code><code class="kotlin string">"<a href="file:///android_asset/">file:///android_asset/</a>"</code><code class="kotlin plain">,getTestHtml(</code><code class="kotlin string">"article_demo"</code><code class="kotlin plain">), </code><code class="kotlin string">"text/html"</code><code class="kotlin plain">, </code><code class="kotlin string">"utf-8"</code><code class="kotlin plain">, </code><code class="kotlin keyword">null</code><code class="kotlin plain">)</code></div></div></td></tr></tbody></table></div></div></pre>
        <ul>
            <li> <p>其加载结果如下： <img src="https://images.sunofbeaches.com/content/2021_08_11/874814978165571584.jpg" alt=""></p> </li>
            <li> <p>关于学习、测试的总结：</p> </li>
        </ul> <p>上文只是讲述实现使用<span class="key_word">..</span>库展示代码的简单使用，下列总结时在开发中慢慢发现的一些特点，期间走了很多弯路，浪费了很多时间，但是这个库的更多用法还有待挖掘：</p>
        <ol>
            <li>在demo实例中代码被<span class="key_word">&lt;pre&gt;</span>标签包裹，这个标签时可以在<span class="key_word">shCore.js</span>中修改的，该属性在77行，应为网站返回的数据中代码使被<span class="key_word">&lt;code&gt;</span>标签包裹的，所以需要修改一下</li>
        </ol> <pre class="code_block"><div><div id="highlighter_886977" class="..  text"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="text plain">/** Name of the tag that .. will automatically look for.</code></div><div class="line number2 index1 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">该代码高亮插件会自动寻找该标签 */</code></div><div class="line number3 index2 alt2"><code class="text plain">tagName : 'code',</code></div></div></td></tr></tbody></table></div></div></pre>
        <ol>
            <li>必须要加载样式文件，不同的样式文件带有不同的主题，并且可以自定义样式，这个在后面还会讲到</li>
        </ol> <pre class="code_block"><div><div id="highlighter_545036" class="..  text"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="text plain">&lt;!-- 加载主题样式 --&gt;</code></div><div class="line number2 index1 alt1"><code class="text plain">&lt;link rel="stylesheet" type="text/css" href="../css/shCore.css"&gt;</code></div><div class="line number3 index2 alt2"><code class="text plain">&lt;link rel="stylesheet" type="text/css" href="../css/shThemeDjango.css"&gt;</code></div></div></td></tr></tbody></table></div></div></pre>
        <ol>
            <li>加载js文件时必须要加载<span class="key_word">XRegExp.js</span>、<span class="key_word">shCore.js</span>两个js文件和对应的不同语言类型的文件，语言类型的文件也可以自定义</li>
        </ol> <pre class="code_block"><div><div id="highlighter_263267" class="..  text"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;script type="text/javascript" src="../js/XRegExp.js"&gt;&lt;/script&gt;</code></div><div class="line number2 index1 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;script type="text/javascript" src="../js/shCore.js"&gt;&lt;/script&gt;</code></div><div class="line number3 index2 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;!-- 加载需要渲染代码的类型 --&gt;</code></div><div class="line number4 index3 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;script type="text/javascript" src="../js/shBrushJava.js"&gt;&lt;/script&gt;</code></div><div class="line number5 index4 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;!-- 自定义渲染kotlin代码 --&gt;</code></div><div class="line number6 index5 alt1"><code class="text plain">&lt;script type="text/javascript" src="../js/shBrushKotlin.js"&gt;&lt;/script&gt;</code></div></div></td></tr></tbody></table></div></div></pre>
        <ol>
            <li> <p>在代码块的标签<span class="key_word">&lt;pre&gt;</span>可以通过控制class的值控制对应的功能：</p> <p>class="brush: java; collapse: true;"</p>
                <ul>
                    <li>brush: 指定code的类型，并需要加载对应的js文件，例如指定java，需要加载<span class="key_word">shBrushJava.js</span></li>
                    <li>collapse: 是否默认收缩隐藏代码</li>
                    <li>class-name： 给高亮的标签新增一个类名</li>
                    <li>first-line : 代码块开始的行号</li>
                    <li>title: 代码块的标题会显示在代码块上方</li>
                    <li>quick-code： 双击是否可以复制和粘贴代码</li>
                    <li>toolbar： 是否使用工具条（启用，代码块右上方有个？方块，但是点击没什么反应）</li>
                    <li>gutter：是否显示行号</li>
                </ul> </li>
            <li>关于class中使用的属性值很多，这里只是列举的几个，主要英语能力有限，测试其他属性发现变化并不明显，还有待大佬解析</li>
        </ol> </li>
</ol>
<h3>适配网站博客文章</h3>
<ol>
    <li>首先是html的模板，先引用js、css资源，和编写额为的自定义样式的css属性和一些js代码供后面拓展，如下：</li>
</ol>
<pre class="code_block"><div><div id="highlighter_561519" class="..  text"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div><div class="line number66 index65 alt1">66</div><div class="line number67 index66 alt2">67</div><div class="line number68 index67 alt1">68</div><div class="line number69 index68 alt2">69</div><div class="line number70 index69 alt1">70</div><div class="line number71 index70 alt2">71</div><div class="line number72 index71 alt1">72</div><div class="line number73 index72 alt2">73</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="text plain">&lt;html lang="en"&gt;</code></div><div class="line number2 index1 alt1"><code class="text plain">&lt;head&gt;</code></div><div class="line number3 index2 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;meta charset="UTF-8"&gt;</code></div><div class="line number4 index3 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;title&gt;Document&lt;/title&gt;</code></div><div class="line number5 index4 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;!-- 引入css文件 --&gt;</code></div><div class="line number6 index5 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;link rel="stylesheet" type="text/css" href="../css/shCore.css"&gt;</code></div><div class="line number7 index6 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;link rel="stylesheet" type="text/css" href="../css/shThemeArticle.css"&gt;</code></div><div class="line number8 index7 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;!-- 引入js文件，两面连个的引用顺序不可变 --&gt;</code></div><div class="line number9 index8 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;script type="text/javascript" src="../js/XRegExp.js"&gt;&lt;/script&gt;</code></div><div class="line number10 index9 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;script type="text/javascript" src="../js/shCore.js"&gt;&lt;/script&gt;</code></div><div class="line number11 index10 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;script type="text/javascript" src="../js/shBrushJava.js"&gt;&lt;/script&gt;</code></div><div class="line number12 index11 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;script type="text/javascript" src="../js/shBrushPowerShell.js"&gt;&lt;/script&gt;</code></div><div class="line number13 index12 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;script type="text/javascript" src="../js/shBrushJScript.js"&gt;&lt;/script&gt;</code></div><div class="line number14 index13 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;script type="text/javascript" src="../js/shBrushSql.js"&gt;&lt;/script&gt;</code></div><div class="line number15 index14 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;script type="text/javascript" src="../js/shBrushXml.js"&gt;&lt;/script&gt;</code></div><div class="line number16 index15 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;script type="text/javascript" src="../js/shBrushPlain.js"&gt;&lt;/script&gt;</code></div><div class="line number17 index16 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;script type="text/javascript" src="../js/shBrushKotlin.js"&gt;&lt;/script&gt;</code></div><div class="line number18 index17 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;script type="text/javascript"&gt;</code></div><div class="line number19 index18 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">...all()</code></div><div class="line number20 index19 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">// 给代码块设置监听事件，当点击时通知给ktolin</code></div><div class="line number21 index20 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">function onTouchStart(e) {</code></div><div class="line number22 index21 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">androidApi.touchEvent(0);</code></div><div class="line number23 index22 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">}</code></div><div class="line number24 index23 alt1">&nbsp;</div><div class="line number25 index24 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">function onTouchEnd(e) {</code></div><div class="line number26 index25 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">androidApi.touchEvent(2);</code></div><div class="line number27 index26 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">}</code></div><div class="line number28 index27 alt1">&nbsp;</div><div class="line number29 index28 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">function onTouchMove(e) {</code></div><div class="line number30 index29 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">androidApi.touchEvent(1);</code></div><div class="line number31 index30 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">}</code></div><div class="line number32 index31 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">function addTouchListener() {</code></div><div class="line number33 index32 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">var dom = document.getElementsByClassName('code');</code></div><div class="line number34 index33 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">androidApi.log(dom.length);</code></div><div class="line number35 index34 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">for (i in dom){</code></div><div class="line number36 index35 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">dom[i].addEventListener('touchstart', onTouchStart, false);</code></div><div class="line number37 index36 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">dom[i].addEventListener('touchmove', onTouchMove, false);</code></div><div class="line number38 index37 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">dom[i].addEventListener('touchend', onTouchEnd, false);</code></div><div class="line number39 index38 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">}</code></div><div class="line number40 index39 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">}</code></div><div class="line number41 index40 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;/script&gt;</code></div><div class="line number42 index41 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;style&gt;</code></div><div class="line number43 index42 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">/* 控制文章中的image不超过屏幕 */</code></div><div class="line number44 index43 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">img {</code></div><div class="line number45 index44 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">max-width: 100%;</code></div><div class="line number46 index45 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">}</code></div><div class="line number47 index46 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">/* 代码块的样式 */</code></div><div class="line number48 index47 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">.code_block{</code></div><div class="line number49 index48 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">display: block;</code></div><div class="line number50 index49 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">overflow-x: auto;</code></div><div class="line number51 index50 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">padding: .5em;</code></div><div class="line number52 index51 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">background: #f0f0f0;</code></div><div class="line number53 index52 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">}</code></div><div class="line number54 index53 alt1">&nbsp;</div><div class="line number55 index54 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">/* 文章中关键字的样式，及markdown中``修饰的文字 */</code></div><div class="line number56 index55 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">.key_word{</code></div><div class="line number57 index56 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">word-break: break-word;</code></div><div class="line number58 index57 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">border-radius: 2px;</code></div><div class="line number59 index58 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">margin-left: 3px;</code></div><div class="line number60 index59 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">margin-right: 3px;</code></div><div class="line number61 index60 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">overflow-x: auto;</code></div><div class="line number62 index61 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">background-color: #f7f7f7;</code></div><div class="line number63 index62 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">color: #ff502c;</code></div><div class="line number64 index63 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">font-size: .87em;</code></div><div class="line number65 index64 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">padding: .065em .4em!important;</code></div><div class="line number66 index65 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">display: inline!important;</code></div><div class="line number67 index66 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">}</code></div><div class="line number68 index67 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">&lt;/style&gt;</code></div><div class="line number69 index68 alt2"><code class="text plain">&lt;/head&gt;</code></div><div class="line number70 index69 alt1"><code class="text plain">&lt;body&gt;</code></div><div class="line number71 index70 alt2"><code class="text plain">{{template}}</code></div><div class="line number72 index71 alt1"><code class="text plain">&lt;/body&gt;</code></div><div class="line number73 index72 alt2"><code class="text plain">&lt;/html&gt;</code></div></div></td></tr></tbody></table></div></div></pre>
<ol>
    <li> <p>在获取到文章数据的基础上对文章内容进行处理：</p> <p>首先时对关键字的处理，前文提到特殊关键字时被<span class="key_word">&lt;code&gt;</span>标签包裹，我们在这里使用正则将其替换成<span class="key_word">&lt;span&gt;</span>标签并添加属性<span class="key_word">key_word</span>,代码如下：</p> <pre class="code_block"><div><div id="highlighter_114234" class="..  kotlin"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="kotlin preprocessor">/**</code></div><div class="line number2 index1 alt1"><code class="kotlin preprocessor">* content：网页返回的文章内容</code></div><div class="line number3 index2 alt2"><code class="kotlin preprocessor">*/</code></div><div class="line number4 index3 alt1"><code class="kotlin keyword">private</code> <code class="kotlin keyword">fun</code> <code class="kotlin function">handleKeywords</code><code class="kotlin plain">(content: String): String {</code></div><div class="line number5 index4 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">var</code> <code class="kotlin plain">handleText = content</code></div><div class="line number6 index5 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">val</code> <code class="kotlin plain">parttern = Regex(</code><code class="kotlin string">"&lt;code&gt;(.*?)&lt;/code&gt;"</code><code class="kotlin plain">)</code></div><div class="line number7 index6 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">val</code> <code class="kotlin plain">results = parttern.findAll(handleText)</code></div><div class="line number8 index7 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">for</code> <code class="kotlin plain">(result in results) {</code></div><div class="line number9 index8 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">var</code> <code class="kotlin plain">keyString: String = result.value</code></div><div class="line number10 index9 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">keyString = keyString.replace(</code><code class="kotlin string">"&lt;code&gt;"</code><code class="kotlin plain">, </code><code class="kotlin string">"&lt;span class=\"key_word\"&gt;"</code><code class="kotlin plain">)</code></div><div class="line number11 index10 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">keyString = keyString.replace(</code><code class="kotlin string">"&lt;/code&gt;"</code><code class="kotlin plain">, </code><code class="kotlin string">"&lt;/span&gt;"</code><code class="kotlin plain">)</code></div><div class="line number12 index11 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">handleText = handleText.replace(result.value, keyString)</code></div><div class="line number13 index12 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">}</code></div><div class="line number14 index13 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">return</code> <code class="kotlin plain">handleText</code></div><div class="line number15 index14 alt2"><code class="kotlin plain">}</code></div></div></td></tr></tbody></table></div></div></pre> <p>再是对代码块的处理,前文中代码块除了被<span class="key_word">&lt;code&gt;</span>标签包裹以为，其中还带有代码语言类型的类名，所以需要将原先的类名进行转换，然后再此基础上加上其他属性的值来控制代码块的样式，也可以直接再shCore.js中进行全局控制，处理代码如下：</p> <pre class="code_block"><div><div id="highlighter_34971" class="..  kotlin"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="kotlin preprocessor">/**</code></div><div class="line number2 index1 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin preprocessor">* content：网页返回的文章内容</code></div><div class="line number3 index2 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin preprocessor">*/</code></div><div class="line number4 index3 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">private</code> <code class="kotlin keyword">fun</code> <code class="kotlin function">handleHtmlContent</code><code class="kotlin plain">(content: String): String {</code></div><div class="line number5 index4 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin comments">//处理文章内容中是关键字的情况</code></div><div class="line number6 index5 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">val</code> <code class="kotlin plain">handleText = handleKeywords(content)</code></div><div class="line number7 index6 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin comments">//读取模板代码</code></div><div class="line number8 index7 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">val</code> <code class="kotlin plain">template = getTestHtml(</code><code class="kotlin string">"article_demo"</code><code class="kotlin plain">)</code></div><div class="line number9 index8 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin comments">//利用jsoup转化未html对象，方便处理</code></div><div class="line number10 index9 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">val</code> <code class="kotlin plain">document = Jsoup.parse(template.replace(</code><code class="kotlin string">"{{template}}"</code><code class="kotlin plain">,handleText))</code></div><div class="line number11 index10 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin comments">//使用递归处理html中的代码块</code></div><div class="line number12 index11 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">verseChild(document.body())</code></div><div class="line number13 index12 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">return</code> <code class="kotlin plain">document.toString()</code></div><div class="line number14 index13 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">}</code></div><div class="line number15 index14 alt2">&nbsp;</div><div class="line number16 index15 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">private</code> <code class="kotlin keyword">fun</code> <code class="kotlin function">verseChild</code><code class="kotlin plain">(body: Element?) {</code></div><div class="line number17 index16 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">body?.</code><code class="kotlin keyword">let</code> <code class="kotlin plain">{</code></div><div class="line number18 index17 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">for</code> <code class="kotlin plain">(child in body.children()) {</code></div><div class="line number19 index18 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">if</code> <code class="kotlin plain">(child.tagName() == </code><code class="kotlin string">"code"</code><code class="kotlin plain">) {</code></div><div class="line number20 index19 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin comments">//给代码父标签添加属性，可以自定义样式</code></div><div class="line number21 index20 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">child.parent().attributes().add(</code><code class="kotlin string">"class"</code><code class="kotlin plain">, </code><code class="kotlin string">"code_block"</code><code class="kotlin plain">)</code></div><div class="line number22 index21 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin comments">//给code设置新的类名，来控制代码的属性</code></div><div class="line number23 index22 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">child.attributes().put(</code><code class="kotlin string">"class"</code><code class="kotlin plain">, </code><code class="kotlin string">"brush: ${getLanguageType(child.attr("</code><code class="kotlin keyword">class</code><code class="kotlin string">"))}; toolbar:false; quick-code:false;"</code><code class="kotlin plain">)</code></div><div class="line number24 index23 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">}</code></div><div class="line number25 index24 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">verseChild(child)</code></div><div class="line number26 index25 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">}</code></div><div class="line number27 index26 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">}</code></div><div class="line number28 index27 alt1"><code class="kotlin plain">}</code></div><div class="line number29 index28 alt2">&nbsp;</div><div class="line number30 index29 alt1"><code class="kotlin preprocessor">/**</code></div><div class="line number31 index30 alt2"><code class="kotlin spaces">&nbsp;</code><code class="kotlin preprocessor">* 将原来内容中的代码类型属性进行转换</code></div><div class="line number32 index31 alt1"><code class="kotlin spaces">&nbsp;</code><code class="kotlin preprocessor">*/</code></div><div class="line number33 index32 alt2"><code class="kotlin keyword">private</code> <code class="kotlin keyword">fun</code> <code class="kotlin function">getLanguageType</code><code class="kotlin plain">(attr: String): String {</code></div><div class="line number34 index33 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">Log.d(TAG, </code><code class="kotlin string">"getLanguageType: $attr"</code><code class="kotlin plain">)</code></div><div class="line number35 index34 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">if</code> <code class="kotlin plain">(attr.isEmpty()) {</code></div><div class="line number36 index35 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">return</code> <code class="kotlin string">"text"</code></div><div class="line number37 index36 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">}</code><code class="kotlin keyword">else</code><code class="kotlin plain">{</code></div><div class="line number38 index37 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">return</code> <code class="kotlin keyword">when</code><code class="kotlin plain">(attr){</code></div><div class="line number39 index38 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin string">"language-shell"</code> <code class="kotlin plain">-&gt; </code><code class="kotlin string">"ps"</code></div><div class="line number40 index39 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin string">"language-java"</code> <code class="kotlin plain">-&gt; </code><code class="kotlin string">"java"</code></div><div class="line number41 index40 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin string">"language-kotlin"</code> <code class="kotlin plain">-&gt; </code><code class="kotlin string">"kotlin"</code></div><div class="line number42 index41 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin string">"language-xml"</code> <code class="kotlin plain">-&gt; </code><code class="kotlin string">"xml"</code></div><div class="line number43 index42 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin string">"language-sql"</code> <code class="kotlin plain">-&gt; </code><code class="kotlin string">"sql"</code></div><div class="line number44 index43 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin string">"language-json"</code> <code class="kotlin plain">-&gt; </code><code class="kotlin string">"text"</code></div><div class="line number45 index44 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">else</code> <code class="kotlin plain">-&gt; </code><code class="kotlin string">"text"</code></div><div class="line number46 index45 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">}</code></div><div class="line number47 index46 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">}</code></div><div class="line number48 index47 alt1"><code class="kotlin plain">}</code></div></div></td></tr></tbody></table></div></div></pre> </li>
    <li> <p>适配文章后的结果如下：</p> <p><img src="https://images.sunofbeaches.com/content/2021_08_13/875698149857951744.png" alt=""></p> </li>
</ol>
<h3>自定义样式、拓展语言类型、交互优化</h3>
<p>..的资源下已经提供很多语言类型和文章主题，但是与网站的文章样式的差异较大，并且还不支持kotlin代码的渲染</p>
<ol>
    <li> <p>自定义样式</p> <p>打开资源中css文件，内容就是代码块的样式属性，但是里面某些类名的意思不是很清楚的，所以需要获取webview中的网页源代码，查看代码发生了什么变化，并且可以直接找到css中的类名修饰了那些html代码</p> <p>获取webview中的网页源代码：</p> <pre class="code_block"><div><div id="highlighter_945325" class="..  kotlin"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="kotlin keyword">class</code> <code class="kotlin plain">DemoJsApi {</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">companion object{</code></div><div class="line number4 index3 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">private</code> <code class="kotlin keyword">const</code> <code class="kotlin keyword">val</code> <code class="kotlin plain">TAG = </code><code class="kotlin string">"DemoJsApi"</code></div><div class="line number5 index4 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">}</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin color1">@JavascriptInterface</code></div><div class="line number8 index7 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">fun</code> <code class="kotlin function">printPageSource</code><code class="kotlin plain">(html: String?) {</code></div><div class="line number9 index8 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">Log.d(TAG, </code><code class="kotlin string">"pageSource: $html"</code><code class="kotlin plain">)</code></div><div class="line number10 index9 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">saveHtml(html!!)</code></div><div class="line number11 index10 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">}</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">private</code> <code class="kotlin keyword">fun</code> <code class="kotlin function">saveHtml</code><code class="kotlin plain">(html: String) {</code></div><div class="line number14 index13 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">val</code> <code class="kotlin plain">f = File(</code><code class="kotlin string">"data/data/com.coder.zt.sobblog/result.html"</code><code class="kotlin plain">)</code></div><div class="line number15 index14 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">if</code> <code class="kotlin plain">(!f.exists()) {</code></div><div class="line number16 index15 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">f.createNewFile()</code></div><div class="line number17 index16 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">}</code></div><div class="line number18 index17 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">val</code> <code class="kotlin plain">fos = FileOutputStream(f)</code></div><div class="line number19 index18 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">val</code> <code class="kotlin plain">input = OutputStreamWriter(BufferedOutputStream(fos))</code></div><div class="line number20 index19 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">val</code> <code class="kotlin plain">bfReader = BufferedWriter(input)</code></div><div class="line number21 index20 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">bfReader.write(html)</code></div><div class="line number22 index21 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">bfReader.flush()</code></div><div class="line number23 index22 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">bfReader.close()</code></div><div class="line number24 index23 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">}</code></div><div class="line number25 index24 alt2"><code class="kotlin spaces">&nbsp;</code><code class="kotlin plain">}</code></div></div></td></tr></tbody></table></div></div></pre> <pre class="code_block"><div><div id="highlighter_380831" class="..  kotlin"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="kotlin comments">//为webview设置js接口</code></div><div class="line number2 index1 alt1"><code class="kotlin plain">dataBinding.wvArticle.addJavascriptInterface(DemoJsApi(), </code><code class="kotlin string">"androidApi"</code><code class="kotlin plain">)</code></div><div class="line number3 index2 alt2"><code class="kotlin comments">//调用js代码获取webview中的网页源代码</code></div><div class="line number4 index3 alt1"><code class="kotlin plain">dataBinding.btnSource.setOnClickListener{</code></div><div class="line number5 index4 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">dataBinding.wvArticle.loadUrl(</code><code class="kotlin string">"javascript:window.androidApi.printPageSource('&lt;head&gt;'+document.getElementsByTagName('html')[0].innerHTML+'&lt;/head&gt;');"</code><code class="kotlin plain">)</code></div><div class="line number6 index5 alt1"><code class="kotlin plain">}</code></div></div></td></tr></tbody></table></div></div></pre> <p>获取网页源代码后，通过比较网页源代码中的类名即可知道css中各个类名修饰的作用，接着结合自己所需要的主题编辑自己的主题css文件</p> </li>
    <li> <p>拓展语言类型-以kotlin为例</p> <p>..的基础资源中已经支持了很多语言类型，而最新的库版本时2016年发布的，所以没有kotlin很正常，当时我也不知到会踏入安卓的大门，哈哈，基础资源支持的语言类型如下：</p> <p><img src="https://images.sunofbeaches.com/content/2021_08_12/875431897491046400.png" alt=""></p> <p>打开一种语言的js文件可以发现其实就是简单编写配置：</p>
        <ol>
            <li>修改function Brush()下的keywords也就是该种语言的关键字</li>
            <li>修改function Brush()下的regexList，这个列表使是使用正则表达式取匹配注解、注释、变量等等，然后再与类名相关联，实现css对代码中的特殊字符的渲染</li>
            <li>修改Bursh.aliases：该属性的值是一个列表，要匹配代码类型的名称</li>
        </ol> </li>
    <li> <p>交互优化</p> <p>界面中只用WebView的时候，在代码块左右滑动是没有问题的，但是我们如果要做打赏列表、评论内容的时候，我们就得把WebView、RecyclerView放在NestedScrollView中，这样就会导致代码块左右滑动与NestedScrollView的上下滑动存在冲突，我的方案如下：</p>
        <ol>
            <li>为代码块设置触摸的监听事件，可以在模板html中看到，代码如下：</li>
        </ol> <pre class="code_block"><div><div id="highlighter_394067" class="..  text"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="text plain">// 给代码块设置监听事件，当点击时通知给ktolin</code></div><div class="line number2 index1 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">function onTouchStart(e) {</code></div><div class="line number3 index2 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">androidApi.touchEvent(0);</code></div><div class="line number4 index3 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">}</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">function onTouchEnd(e) {</code></div><div class="line number7 index6 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">androidApi.touchEvent(2);</code></div><div class="line number8 index7 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">}</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">function onTouchMove(e) {</code></div><div class="line number11 index10 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">androidApi.touchEvent(1);</code></div><div class="line number12 index11 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">}</code></div><div class="line number13 index12 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">//</code></div><div class="line number14 index13 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">function addTouchListener() {</code></div><div class="line number15 index14 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">var dom = document.getElementsByClassName('code');</code></div><div class="line number16 index15 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">androidApi.log(dom.length);</code></div><div class="line number17 index16 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">for (i in dom){</code></div><div class="line number18 index17 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">dom[i].addEventListener('touchstart', onTouchStart, false);</code></div><div class="line number19 index18 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">dom[i].addEventListener('touchmove', onTouchMove, false);</code></div><div class="line number20 index19 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">dom[i].addEventListener('touchend', onTouchEnd, false);</code></div><div class="line number21 index20 alt2"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">}</code></div><div class="line number22 index21 alt1"><code class="text spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="text plain">}</code></div></div></td></tr></tbody></table></div></div></pre> <pre class="code_block"><div><div id="highlighter_594429" class="..  text"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="text plain">等待WebView加载完毕，调用js方法，为代码块添加监听事件</code></div></div></td></tr></tbody></table></div></div></pre> <pre class="code_block"><div><div id="highlighter_205242" class="..  kotlin"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="kotlin comments">//重写WebViewClient的子方法</code></div><div class="line number2 index1 alt1"><code class="kotlin keyword">override</code> <code class="kotlin keyword">fun</code> <code class="kotlin function">onPageFinished</code><code class="kotlin plain">(view: WebView?, url: String?) {</code></div><div class="line number3 index2 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">super</code><code class="kotlin plain">.onPageFinished(view, url)</code></div><div class="line number4 index3 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">view?.loadUrl(</code><code class="kotlin string">"javascript:addTouchListener()"</code><code class="kotlin plain">)</code></div><div class="line number5 index4 alt2"><code class="kotlin plain">}</code></div></div></td></tr></tbody></table></div></div></pre>
        <ol>
            <li>通过回调的事件来分发触摸事件：</li>
        </ol> <pre class="code_block"><div><div id="highlighter_125802" class="..  kotlin"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="kotlin comments">//JsApi：接收js的回调</code></div><div class="line number2 index1 alt1"><code class="kotlin color1">@JavascriptInterface</code></div><div class="line number3 index2 alt2"><code class="kotlin keyword">fun</code> <code class="kotlin function">touchEvent</code><code class="kotlin plain">(eventCode: Int) {</code></div><div class="line number4 index3 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">Log.d(TAG, </code><code class="kotlin string">"touchEvent: $eventCode"</code><code class="kotlin plain">)</code></div><div class="line number5 index4 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">when</code><code class="kotlin plain">(eventCode){</code></div><div class="line number6 index5 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin value">0</code> <code class="kotlin plain">-&gt; callback.invoke(EventCode.Event_DOWN)</code></div><div class="line number7 index6 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin value">1</code> <code class="kotlin plain">-&gt; callback.invoke(EventCode.Event_MOVE)</code></div><div class="line number8 index7 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin value">2</code> <code class="kotlin plain">-&gt; callback.invoke(EventCode.Event_UP)</code></div><div class="line number9 index8 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">}</code></div><div class="line number10 index9 alt1"><code class="kotlin plain">}</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="kotlin comments">//重写WebView的子类：wbsv是重写的NestedScrollView,控制其是否可以滑动</code></div><div class="line number13 index12 alt2"><code class="kotlin plain">addJavascriptInterface(JsApi(){</code></div><div class="line number14 index13 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">when</code><code class="kotlin plain">(it){</code></div><div class="line number15 index14 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">JsApi.EventCode.Event_UP-&gt;{</code></div><div class="line number16 index15 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">wbsv?.setSlide(</code><code class="kotlin keyword">true</code><code class="kotlin plain">)</code></div><div class="line number17 index16 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">}</code></div><div class="line number18 index17 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">JsApi.EventCode.Event_MOVE-&gt;{</code></div><div class="line number19 index18 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">wbsv?.setSlide(slideDir)</code></div><div class="line number20 index19 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">}</code></div><div class="line number21 index20 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">JsApi.EventCode.Event_DOWN-&gt;{</code></div><div class="line number22 index21 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">wbsv?.setSlide(slideDir )</code></div><div class="line number23 index22 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">}</code></div><div class="line number24 index23 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">}</code></div><div class="line number25 index24 alt2"><code class="kotlin plain">}, </code><code class="kotlin string">"androidApi"</code><code class="kotlin plain">) </code><code class="kotlin comments">//AndroidtoJS类对象映射到js的test对象</code></div><div class="line number26 index25 alt1">&nbsp;</div><div class="line number27 index26 alt2"><code class="kotlin comments">//重写WebView的子类：判断WebView的触摸事件，判断是否恢复NestedScrollView的滑动</code></div><div class="line number28 index27 alt1"><code class="kotlin keyword">override</code> <code class="kotlin keyword">fun</code> <code class="kotlin function">onTouchEvent</code><code class="kotlin plain">(event: MotionEvent?): Boolean {</code></div><div class="line number29 index28 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">event?.</code><code class="kotlin keyword">let</code> <code class="kotlin plain">{</code></div><div class="line number30 index29 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">val</code> <code class="kotlin plain">currentX =event.x</code></div><div class="line number31 index30 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">val</code> <code class="kotlin plain">currentY = event.y</code></div><div class="line number32 index31 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">when</code> <code class="kotlin plain">(event.action) {</code></div><div class="line number33 index32 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">MotionEvent.ACTION_DOWN -&gt; {</code></div><div class="line number34 index33 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">startX = currentX</code></div><div class="line number35 index34 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">startY = currentY</code></div><div class="line number36 index35 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">}</code></div><div class="line number37 index36 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">MotionEvent.ACTION_MOVE -&gt; {</code></div><div class="line number38 index37 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">slideDir = kotlin.math.abs(currentX - startX) &lt;= kotlin.math.abs(currentY - startY)</code></div><div class="line number39 index38 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">}</code></div><div class="line number40 index39 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">MotionEvent.ACTION_UP -&gt; {</code></div><div class="line number41 index40 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">}</code></div><div class="line number42 index41 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">else</code> <code class="kotlin plain">-&gt; {</code></div><div class="line number43 index42 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">}</code></div><div class="line number44 index43 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">}</code></div><div class="line number45 index44 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">}</code></div><div class="line number46 index45 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">return</code> <code class="kotlin keyword">super</code><code class="kotlin plain">.onTouchEvent(event)</code></div><div class="line number47 index46 alt2"><code class="kotlin plain">}</code></div></div></td></tr></tbody></table></div></div></pre> </li>
    <li> <p>WebView中的链接处理</p> <pre class="code_block"><div><div id="highlighter_809293" class="..  kotlin"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="kotlin preprocessor">/**</code></div><div class="line number2 index1 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin preprocessor">* 重写WebViewClient的此方法，即可使WebView不再跳转</code></div><div class="line number3 index2 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin preprocessor">*/</code></div><div class="line number4 index3 alt1"><code class="kotlin keyword">override</code> <code class="kotlin keyword">fun</code> <code class="kotlin function">shouldOverrideUrlLoading</code><code class="kotlin plain">(view: WebView?, url: String?): Boolean {</code></div><div class="line number5 index4 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">url?.</code><code class="kotlin keyword">let</code> <code class="kotlin plain">{</code></div><div class="line number6 index5 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">callback.invoke(it)</code></div><div class="line number7 index6 alt2"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin plain">}</code></div><div class="line number8 index7 alt1"><code class="kotlin spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kotlin keyword">return</code> <code class="kotlin keyword">true</code></div><div class="line number9 index8 alt2"><code class="kotlin plain">}</code></div></div></td></tr></tbody></table></div></div></pre> </li>
</ol>
<p>通过上面的处理就可以解决代码块的滑动浏览问题了，到这里自定义样式、拓展语言类型、交互优化就结束了，这其中肯定还有待优化的地方，待以后结合实际使用体验慢慢进行优化处理。</p>
<h3>拿来吧你</h3>
<ul>
    <li>项目地址：https://github.com/coder-zt/SOBBlog</li>
    <li> <p>相关类：</p>
        <ul>
            <li><a href="https://github.com/coder-zt/SOBBlog/blob/master/app/src/main/java/com/coder/zt/sobblog/ui/view/ArticleWebView.kt">ArticleWebView</a></li>
            <li><a href="https://github.com/coder-zt/SOBBlog/blob/master/app/src/main/java/com/coder/zt/sobblog/ui/view/webwiew/ArticleWebViewClient.kt">ArticleWebViewClient</a></li>
            <li><a href="https://github.com/coder-zt/SOBBlog/blob/master/app/src/main/java/com/coder/zt/sobblog/ui/view/webwiew/JsApi.kt">JsApi</a></li>
        </ul> </li>
    <li class="too-len">相关资源：https://github.com/coder-zt/SOBBlog/tree/master/app/src/main/assets/syntaxhighlighter</li>
</ul>
<p>只需要将上面几个类和JS库的相关资源搬到自己项目中然后使用<span class="key_word">ArticleWebView.loadArticle(content)</span>即可实现对博客文章的渲染</p>
<h3>总结</h3>
<pre class="code_block"><div><div id="highlighter_454513" class="..  text"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="text plain">这篇文章刚好是我在这里发布的第10篇文章，由于中途去做了其他事，所以比预期发布时间晚了很多。这篇文章篇幅还是挺多的，但是可能还是有些地方还有待补充，欢迎同学们一起交流学习！</code></div></div></td></tr></tbody></table></div></div></pre>

</body></head>